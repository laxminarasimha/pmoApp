<div ng-controller="resourceMappingCtrl">
  <form name="resourceMappingForm" ng-submit="createResourceMapping(resourcemap)" novalidate>
    <legend>Resource mapping (
      <label ng-show="resourcemap._id!=null">Edit</label>
      <label ng-hide="resourcemap._id!=null">Create</label>)
    </legend>
    <div class="panel panel-info">
      <div class="panel-heading">
        <div class='row'>
          <div class='col-sm-3'>
            <div class=form-group>
              <label for="resourcename">Resource Name</label><br/>
              
              <!--<input type="text" list="resourcemap" ng-show="resourcemap._id==null" ng-model="resourcemap.mappedResource" style="width: 290px; padding: 2px" required>
              <datalist id="resourcemap">
                <option ng-repeat="x in resourceList" value="{{x.resourcename}}"></option>
              </datalist>-->
              
              <select ng-show="resourcemap._id==null" ng-model="resourcemap.mappedResource" ng-options="x.resourcename for x in resourceList"
                class="form-control input-sm {{errorClass}}">
                  </select>

              <input ng-show="resourcemap._id!=null" id="resourcename" ng-model="resourcemap.mappedResource.resourcename" type="text" disabled
                class="form-control input-sm" />
            </div>
          </div>

          <div class='col-sm-3'>
            <div class=form-group>
              <label for="alias">Alias </label>
              <input id="alias" ng-model="resourcemap.mappedResource.alias" required="true" type="text" disabled class="form-control input-sm {{errorClass}}"
              />
            </div>
          </div>

          <div class='col-sm-3'>
            <div class=form-group>
              <label for="designation">Designation</label>
              <input id="designation" ng-model="resourcemap.mappedResource.designation" required="true" type="text" disabled class="form-control input-sm {{errorClass}}"
              />
            </div>
          </div>

          <div class='col-sm-3'>
            <div class=form-group>
              <label for="role">Role</label>
              <select ng-model="resourcemap.mappedResource.role" id="role" class="form-control input-sm {{errorClass}}" disabled>
              <option ng-repeat="x in roleList" value="{{x.rolename}}">{{x.rolename}}</option>
           </select>
            </div>

          </div>
        </div>

        <div class='row'>
          <div class='col-sm-3'>
            <div class=form-group>
              <label for="location">Location</label>
              <select ng-model="resourcemap.mappedResource.baseentity" id="location" class="form-control input-sm {{errorClass}}" disabled>
              <option ng-repeat="x in locationList" value="{{x.locationname}}">{{x.locationname}}</option>
           </select>
            </div>
          </div>

          <div class='col-sm-3'>
            <div class=form-group>
              <label for="skill">Skill</label>
              <select ng-model="resourcemap.mappedResource.skill" id="skill" class="form-control input-sm {{errorClass}}" disabled>
              <option ng-repeat="x in skillSetList" value="{{x.skillname}}">{{x.skillname}}</option>
           </select>
            </div>
          </div>

          <div class='col-sm-3'>
            <div class=form-group>
              <label for="region">Region</label>
              <select ng-model="resourcemap.region" id="region" class="form-control input-sm {{errorClass}}">
              <option ng-repeat="x in regionList" value="{{x.regionname}}">{{x.regionname}}</option>
           </select>
            </div>
          </div>




          <div class='col-sm-3'>
            <!--<div class=form-group>
              <label for="status">Status</label>
              <select ng-model="resourcemap.status" id="status" class="form-control input-sm {{errorClass}}">
              <option ng-repeat="x in statusList" value="{{x.statusname}}">{{x.statusname}}</option>
           </select>
            </div>-->

            <div class=form-group>
              <label for="resourceType">Type</label>
              <select ng-model="resourcemap.resourceType" id="resourceType" class="form-control input-sm {{errorClass}}">
              <option ng-repeat="x in resourceTypeList" value="{{x.resourceTypename}}">{{x.resourceTypename}}</option>
           </select>
            </div>
          </div>

        </div>
        <div class='row'>
          <div class='col-sm-3'>

            <!-- <div class=form-group>
              <label for startDate>Tagged Start Date:</label>
              <input type="text" ng-model="startDate" id="startDate" class="form-control" ng-change="createMapping();" />
            </div> -->

            <div class="form-group">
              <label for startDate>Tagged Start Date:</label>
              <div class="input-group date form_date " data-date="" data-date-format="dd MM yyyy" data-link-format="yyyy-mm-dd">
                <input class="form-control" type="text" ng-model="startDate" ng-change="createMapping();" readonly>
                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
              </div>
            </div>


          </div>
          <div class='col-sm-3'>
            <!-- <div class=form-group>
              <label for endDate>Tagged End Date:</label>
              <input type="text" ng-model="endDate" id="endDate" class="form-control" ng-change="createMapping();" />
            </div> -->

            <div class="form-group">
              <label for endDate>Tagged End Date:</label>
              <div class="input-group date form_date " data-date="" data-date-format="dd MM yyyy" data-link-format="yyyy-mm-dd">
                <input class="form-control" type="text" ng-model="endDate" ng-change="createMapping();" readonly>
                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
              </div>
            </div>

          </div>
        </div>
        <div class="table-responsive" ng-style="{'overflow-y':visible, 'display':hidden}">
          <div class='box-header' >
            <b>Tagged %</b>

            <div class='box-content'>
              <table class="table table-striped table-curved " cellspacing="0 ">
                <thead>
                  <tr class="danger ">
                    <th style="text-align: center;color:green" ng-repeat="column in taggedToEuroclearList ">{{column}}</th>
                  </tr>
                  <thead>
                    <tbody>
                      <tr>
                        <td ng-repeat="column in taggedToEuroclearList track by $index">
                          <input id="taggToEuroclear{{column}}" ng-model="resourcemap.taggToEuroclear[$index].value
            " required="true " type="text " maxlength="3 " size="5 " class="form-control input-sm {{errorClass}}" ng-change="validateInput(this,resourcemap.taggToEuroclear[$index].value)"
                            ng-readonly="checkmonth(taggedToEuroclearList[$index])" />
                        </td>
                      </tr>
                    </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class='row'>
          <div class='col-sm-12'>
            <div align="right">
              <input type="button" value="Update" ng-click="saveData(resourcemap)" class="btn btn-primary" ng-show="resourcemap._id!=null"
              />
              <input type="submit" value="Create"  class="btn btn-primary" ng-hide="resourcemap._id!=null"
              />
              <button class="btn btn-warning" ng-click="clearFields()" type="button">Clear</button>
            </div>
          </div>
        </div>
      </div>
      <div class="panel-body" ng-show="loading || successMsg || errorMsg">
        <div class="row">
          <div class='col-sm-12'>
            <div class="jumbotron text-center" ng-show="loading">
              <span class="glyphicon glyphicon-repeat spinner"></span>
              <p>Loading...</p>
            </div>
            <div class="row show-hide-message" ng-show="successMsg">
              <div class="alert alert-success">{{successMsg}}</div>
            </div>
            <div class="row show-hide-message" ng-show="errorMsg">
              <div class="alert alert-danger" ng-repeat="errorMsg in errorMsgs track by $index">{{errorMsg}}</div>
            </div>

          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="confirmModal" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header bg-primary">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Are you sure to delete the record?</h4>
            </div>
            <div class="modal-body">
              <p>Record will be deleted permanently.</p>
              <input class="form-control" type="text" id="msgID" ng-model="msg" disabled/>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="cancel($event)">Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="deleteResourceMapping($event)">Yes</button>
            </div>
          </div>
        </div>
      </div>

      <div class="panel-footer">
        <div class="panel-body">
          <table class="table table-striped table-curved" cellspacing="0" width="100%" datatable="ng" dt-options="vm.dtOptions" dt-instance="vm.dtInstance">
            <thead class="bg-primary">
              <tr>
                <th></th>
                <th>Resource Name</th>
                <th>Kin ID</th>
                <!-- <th>Resource Type</th> -->
                <th>Designation</th>
                <th>Role</th>
                <th>Location</th>
                <th>Skill</th>
                <th>Year</th>
                <th>Region</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="x in filterResourceWithYear">
                <td align="center"><a class="green shortinfo" href="javascript:;" ng-click="childInfo(x.mappedResource.resourcename,x.year, $event)"
                    title="Click to view more"><i class="glyphicon glyphicon-plus-sign"></a></td>
                <td>{{x.mappedResource.resourcename +' ('+x.mappedResource.alias+')'}}</td>
                <td>{{x.mappedResource.kinId}}</td>
                <td>{{x.mappedResource.designation}}</td>
                <td>{{x.mappedResource.role}}</td>
                <td>{{ x.mappedResource.baseentity }}</td>
                <td>{{ x.mappedResource.skill }}</td>
                <td>{{x.year}}</td>
                <td>{{x.region}}</td>
                <td style="width:3%;text-align:center">
                  <span class="label">
                  <a class="green"  ng-click="editResourceMapping()" title="Edit Record"><i class="glyphicon glyphicon-pencil"></i></a> 
                  </span>
                  <span class="label">
                  <a class="red"  data-toggle="modal" 
                      ng-click="deleteConfirmation(x._id,'Name:'+x.mappedResource.resourcename+',Kin Id:'+x.mappedResource.kinId+',Year:'+x.year)" title="Delete Record"><i class="glyphicon glyphicon-remove"></i></a>
                  </span>
                  </td>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="container" id="spinner">
              <div ng-if="ShowSpinnerStatus" class="loader"></div>
            </div>
        </div>
      </div>
    </div>
  </form>
</div>

<script>
  $('.form_date').datetimepicker({
    format: "mm/yyyy",
    startView: "year",
    minView: "year",
    autoclose: 1,
    startDate: '-0m'
  });

</script>
<style>
  .loader {
				border: 16px solid #f3f3f3; /* Light grey */
				border-top: 16px solid #3498db; /* Blue */
				border-radius: 50%;
				width: 120px;
				height: 120px;
				animation: spin 2s linear infinite;
				margin: 0 auto;
			}

			@keyframes spin {
				0% { transform: rotate(0deg); }
				100% { transform: rotate(360deg); }
			}
			html, body, container {
				height: 100%;
				width: 100%;
				margin: 0;
			}
</style>